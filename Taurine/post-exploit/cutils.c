//
//  nvramutils.c
//  Chimera
//
//  Created by CoolStar on 9/3/19.
//  Copyright Â© 2019 Electra Team. All rights reserved.
//

#include "cutils.h"
#include <ptrauth.h>
#include <dlfcn.h>
#include <sys/stat.h>
#include <sys/sysctl.h>
#include <spawn.h>

#define tar "/taurine/tar"

#if DEBUG
extern void swiftDebug_internal(const char *);
void swiftDebug(const char *format, ...){
    va_list args;
    va_start(args, format);
    
    size_t bufSz = vsnprintf(NULL, 0, format, args);
    char *buf = malloc(bufSz + 1);
    vsnprintf(buf, bufSz + 1, format, args);
    swiftDebug_internal(buf);
    free(buf);
    va_end(args);
}
#endif

uint64_t lookup_key_in_dicts(dict_entry_t *os_dict_entries, uint32_t count, uint64_t key){
    uint64_t value = 0;
    for (int i = 0; i < count; ++i){
        if (os_dict_entries[i].key == key){
            value = os_dict_entries[i].value;
            break;
        }
    }
    return value;
}

#ifdef MAINAPP
void iterate_keys_in_dict(dict_entry_t *os_dict_entries, uint32_t count, void (^callback)(uint64_t key, uint64_t value)){
    for (int i = 0; i < count; ++i){
        callback(os_dict_entries[i].key, os_dict_entries[i].value);
    }
}
#endif

bool isArm64e(void){
#if __arm64e__
    return (ptrauth_sign_unauthenticated((void *)0x12345, ptrauth_key_asia, 0) != (void *)0x12345);
#else
    return false;
#endif
}

extern uint64_t rk64(uint64_t);
uint64_t rk64ptr(uint64_t where){
    uint64_t raw = rk64(where);
#if __arm64e__
    if (raw){
        raw |= 0xffffff8000000000;
    }
#endif
    return raw;
}

uint64_t signPtr(uint64_t data, uint64_t key) {
    return (uint64_t)ptrauth_sign_unauthenticated((void *)data, ptrauth_key_asia, key);
}

uint64_t getFp(arm_thread_state64_t state){
#if __arm64e__
    if (state.__opaque_flags & __DARWIN_ARM_THREAD_STATE64_FLAGS_NO_PTRAUTH){
        return (uint64_t)state.__opaque_fp;
    }
    return (uint64_t)ptrauth_strip(state.__opaque_fp, ptrauth_key_process_independent_code);
#else
    return state.__fp;
#endif
}

uint64_t getLr(arm_thread_state64_t state){
#if __arm64e__
    if (state.__opaque_flags & __DARWIN_ARM_THREAD_STATE64_FLAGS_NO_PTRAUTH){
        return (uint64_t)state.__opaque_lr;
    }
    uint64_t lr = (uint64_t)ptrauth_strip(state.__opaque_lr, ptrauth_key_process_independent_code);
    return lr;
#else
    return state.__lr;
#endif
}

uint64_t getSp(arm_thread_state64_t state){
#if __arm64e__
    if (state.__opaque_flags & __DARWIN_ARM_THREAD_STATE64_FLAGS_NO_PTRAUTH){
        return (uint64_t)state.__opaque_sp;
    }
    return (uint64_t)ptrauth_strip(state.__opaque_sp, ptrauth_key_process_independent_code);
#else
    return state.__sp;
#endif
}

uint64_t getPc(arm_thread_state64_t state){
#if __arm64e__
    if (state.__opaque_flags & __DARWIN_ARM_THREAD_STATE64_FLAGS_NO_PTRAUTH){
        return (uint64_t)state.__opaque_pc;
    }
    return (uint64_t)ptrauth_strip(state.__opaque_pc, ptrauth_key_process_independent_code);
#else
    return state.__pc;
#endif
}

void setLr(arm_thread_state64_t *state, uint64_t lr){
#if __arm64e__
#if DEBUG
    if (lr == (uint64_t)ptrauth_strip((void *)lr, ptrauth_key_asia)){
        fprintf(stderr, "Warning: LR needs to be signed on arm64e!\n");
    }
#endif
    state->__opaque_flags = state->__opaque_flags & ~__DARWIN_ARM_THREAD_STATE64_FLAGS_IB_SIGNED_LR;
    state->__opaque_lr = (void *)lr;
#else
    state->__lr = lr;
#endif
}

void setPc(arm_thread_state64_t *state, uint64_t pc){
#if __arm64e__
#if DEBUG
    if (pc == (uint64_t)ptrauth_strip((void *)pc, ptrauth_key_asia)){
        fprintf(stderr, "Warning: PC needs to be signed on arm64e!\n");
    }
#endif
    state->__opaque_pc = (void *)pc;
#else
    state->__pc = pc;
#endif
}

uint64_t findSymbol(const char *symbol){
    return (uint64_t)ptrauth_strip(dlsym(RTLD_DEFAULT, symbol), ptrauth_key_asia);
}

#ifdef ENABLE_XPC
xpc_object_t xpc_bootstrap_pipe(void) {
    struct xpc_global_data *xpc_gd = _os_alloc_once_table[1].ptr;
    return xpc_gd->xpc_bootstrap_pipe;
}

bool xpc_object_is_dict(xpc_object_t obj){
    return xpc_get_type(obj) == XPC_TYPE_DICTIONARY;
}
#endif

char *myenviron[] = {
    "PATH=/pwnremover/:/taurine/usr/local/sbin:/taurine/usr/local/bin:/taurine/usr/sbin:/taurine/usr/bin:/taurine/sbin:/taurine/bin:/taurine/:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/bin/X11:/usr/games",
    "PS1=\\h:\\w \\u\\$ ",
    NULL
};

pid_t pd;
extern char **environ;

void shmodtar() {
    chown("/taurine/tar", 0, 0);
    chmod("/taurine/tar", 0755);
}
bool file_exist(const char *filename) {
    struct stat buffer;
    int r = stat(filename, &buffer);
    return (r == 0);
}


void makeamera(){
    mkdir("/taurine/bin/", 0755);
    chown("/taurine/bin/", 0, 0);
    mkdir("/taurine/usr/", 0755);
    chown("/taurine/usr/", 0, 0);
    mkdir("/taurine/usr/bin/", 0755);
    chown("/taurine/usr/bin/", 0, 0);
}
void makeodddss(){
    mkdir("/taurine/", 0755);
    chown("/taurine/", 0, 0);
    mkdir("/taurine/bin/", 0755);
    chown("/taurine/bin/", 0, 0);
    mkdir("/taurine/usr/", 0755);
    chown("/taurine/usr/", 0, 0);
    mkdir("/taurine/usr/bin/", 0755);
    chown("/taurine/usr/bin/", 0, 0);
    //mkdir("/taurine/cstmp/", 0700);
    mkdir("/taurine/cstmp/", 0777);
    chown("/taurine/cstmp/", 0, 0);
}
void makepwn(){
    mkdir("/taurine/pwnny", 0755);
    chown("/taurine/pwnny", 0, 0);
    mkdir("/pwnremover", 0755);
    chown("/pwnremover", 0, 0);

}
void makeTh0r(){
    mkdir("/Th0r", 0755);
    chown("/Th0r", 0, 0);
}

double uptime(){
    struct timeval boottime;
    size_t len = sizeof(boottime);
    int mib[2] = { CTL_KERN, KERN_BOOTTIME };
    if( sysctl(mib, 2, &boottime, &len, NULL, 0) < 0 )
    {
        return -1.0;
    }
    time_t bsec = boottime.tv_sec, csec = time(NULL);
    
    return difftime(csec, bsec);
}

uint64_t anuptimeaway(int uptimesymbol){
    int upme = ((uptime()/60)/60)/24;
    int anewuptime = (uptime());
    return upme;
}
#define FLAG_PLATFORMIZE (1 << 1)

void makingthingsDir(){
    mkdir("/pwnny", 0755);
}

void modsymlink_binbag() {
    chown("/taurine/bin/binbag", 0, 0);
    chmod("/taurine/bin/binbag", 0755);
    posix_spawn(&pd, "/taurine/tar", NULL, NULL, (char **)&(const char*[]){ "/taurine/tar", "--preserve-permissions", "-xpf", "/pwnremover/uicache.tar", "-C", "/pwnremover/", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    symlink("/taurine/bin/binbag", "/taurine/bin/mount");
    symlink("/taurine/bin/binbag", "/taurine/bin/umount");
    symlink("/taurine/bin/binbag", "/taurine/bin/chflags");
    symlink("/taurine/bin/binbag", "/taurine/bin/chmod");
    symlink("/taurine/bin/binbag", "/taurine/bin/chown");
    symlink("/taurine/bin/binbag", "/taurine/bin/chgrp");
    symlink("/taurine/bin/binbag", "/taurine/bin/cp");
    symlink("/taurine/bin/binbag", "/taurine/bin/dd");
    symlink("/taurine/bin/binbag", "/taurine/bin/df");
    symlink("/taurine/bin/binbag", "/taurine/bin/du");
    symlink("/taurine/bin/binbag", "/taurine/bin/ln");
    symlink("/taurine/bin/binbag", "/taurine/bin/ls");
    symlink("/taurine/bin/binbag", "/taurine/bin/mkdir");
    symlink("/taurine/bin/binbag", "/taurine/bin/mkfifo");
    symlink("/taurine/bin/binbag", "/taurine/bin/mknod");
    symlink("/taurine/bin/binbag", "/taurine/bin/mv");
    symlink("/taurine/bin/binbag", "/taurine/bin/readlink");
    symlink("/taurine/bin/binbag", "/taurine/bin/rm");
    symlink("/taurine/bin/binbag", "/taurine/bin/rmdir");
    symlink("/taurine/bin/binbag", "/taurine/bin/stat");
    symlink("/taurine/bin/binbag", "/taurine/bin/touch");
    symlink("/taurine/bin/binbag", "/taurine/bin/netcat");
    symlink("/taurine/bin/binbag", "/taurine/bin/arp");
    symlink("/taurine/bin/binbag", "/taurine/bin/ifconfig");
    symlink("/taurine/bin/binbag", "/taurine/bin/netstat");
    symlink("/taurine/bin/binbag", "/taurine/bin/ping");
    symlink("/taurine/bin/binbag", "/taurine/bin/traceroute");
    symlink("/taurine/bin/binbag", "/taurine/bin/basename");
    symlink("/taurine/bin/binbag", "/taurine/bin/date");
    symlink("/taurine/bin/binbag", "/taurine/bin/dirname");
    symlink("/taurine/bin/binbag", "/taurine/bin/expr");
    symlink("/taurine/bin/binbag", "/taurine/bin/find");
    symlink("/taurine/bin/binbag", "/taurine/bin/id");
    symlink("/taurine/bin/binbag", "/taurine/bin/hexdump");
    symlink("/taurine/bin/binbag", "/taurine/bin/hostname");
    symlink("/taurine/bin/binbag", "/taurine/bin/jot");
    symlink("/taurine/bin/binbag", "/taurine/bin/killall");
    symlink("/taurine/bin/binbag", "/taurine/bin/mktemp");
    symlink("/taurine/bin/binbag", "/taurine/bin/nice");
    symlink("/taurine/bin/binbag", "/taurine/bin/nohup");
    symlink("/taurine/bin/binbag", "/taurine/bin/printf");
    symlink("/taurine/bin/binbag", "/taurine/bin/pwd");
    symlink("/taurine/bin/binbag", "/taurine/bin/renice");
    symlink("/taurine/bin/binbag", "/taurine/bin/script");
    symlink("/taurine/bin/binbag", "/taurine/bin/seq");
    symlink("/taurine/bin/binbag", "/taurine/bin/sleep");
    symlink("/taurine/bin/binbag", "/taurine/bin/systime");
    symlink("/taurine/bin/binbag", "/taurine/bin/tee");
    symlink("/taurine/bin/binbag", "/taurine/bin/test");
    symlink("/taurine/bin/binbag", "/taurine/bin/time");
    symlink("/taurine/bin/binbag", "/taurine/bin/uname");
    symlink("/taurine/bin/binbag", "/taurine/bin/w");
    symlink("/taurine/bin/binbag", "/taurine/bin/what");
    symlink("/taurine/bin/binbag", "/taurine/bin/which");
    symlink("/taurine/bin/binbag", "/taurine/bin/xargs");
    symlink("/taurine/bin/binbag", "/taurine/bin/hostinfo");;
    symlink("/taurine/bin/binbag", "/taurine/bin/lsmp");
    symlink("/taurine/bin/binbag", "/taurine/bin/mean");
    symlink("/taurine/bin/binbag", "/taurine/bin/nvram");
    symlink("/taurine/bin/binbag", "/taurine/bin/reboot");
    symlink("/taurine/bin/binbag", "/taurine/bin/sc_usage");
    symlink("/taurine/bin/binbag", "/taurine/bin/stackshot");
    symlink("/taurine/bin/binbag", "/taurine/bin/sysctl");
    symlink("/taurine/bin/binbag", "/taurine/bin/trace");
    symlink("/taurine/bin/binbag", "/taurine/bin/cat");
    symlink("/taurine/bin/binbag", "/taurine/bin/cut");
    symlink("/taurine/bin/binbag", "/taurine/bin/comm");
    symlink("/taurine/bin/binbag", "/taurine/bin/grep");
    symlink("/taurine/bin/binbag", "/taurine/bin/head");
    symlink("/taurine/bin/binbag", "/taurine/bin/split");
    symlink("/taurine/bin/binbag", "/taurine/bin/sort");
    symlink("/taurine/bin/binbag", "/taurine/bin/tail");
    symlink("/taurine/bin/binbag", "/taurine/bin/tr");
    symlink("/taurine/bin/binbag", "/taurine/bin/uniq");
    symlink("/taurine/bin/binbag", "/taurine/bin/wc");
}

void extract_bootstrap(){

    if (file_exist("/.bootstrapped_Th0r14")){
        printf("Th0r skipping bootstrapping\n");
        goto end;
    }else {
        printf("extract bootstrap\n");
        printf("Th0r starting extraction and installation\n");
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/bin/gzip", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/bin/gzip", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/bin/tar", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/usr/bin/tar", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/bin/gunzip", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/bin/gunzip", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/bin/gzexe", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/bin/gzexe", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, tar, NULL, NULL, (char **)&(const char*[]){ tar, "--preserve-permissions", "-xf", "/taurine/gzip.tar", "-C", "/bin/", NULL }, (char **)&myenviron);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, tar, NULL, NULL, (char **)&(const char*[]){ tar, "--preserve-permissions", "-xf", "/taurine/gzip.tar", "-C", "/usr/bin/", NULL }, (char **)&myenviron);
        waitpid(pd, NULL, 0);
        chown("/taurine/bin/gzip", 0, 0);
        chmod("/taurine/bin/gzip", 0755);
        chown("/bin/gzip", 0, 0);
        chmod("/bin/gzip", 0755);
        chown("/bin/gzexe", 0, 0);
        chmod("/bin/gzexe", 0755);
        chown("/bin/gunzip", 0, 0);
        chmod("/bin/gunzip", 0755);
        chown("/usr/bin/gzip", 0, 0);
        chmod("/usr/bin/gzip", 0755);
        chown("/usr/bin/gzexe", 0, 0);
        chmod("/usr/bin/gzexe", 0755);
        chown("/usr/bin/gunzip", 0, 0);
        chmod("/usr/bin/gunzip", 0755);
        
        
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/bin/bash", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/bin/sh", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/usr/lib/libform.dylib", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/usr/lib/libncurses.5.dylib", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/usr/lib/libresolv.dylib", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/usr/include", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/Library/Frameworks", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/Library/LaunchDaemons", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/usr/lib/libcurses.dylib", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/usr/lib/libncurses.dylib", NULL }, NULL);
        waitpid(pd, NULL, 0);

        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/private/var/log/dpkg", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/usr/lib/liblzma.dylib", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/private/etc/ssl", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/Library/MobileSubstrate", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/usr/lib/TweakInject", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "rm", "-rdf", "/usr/lib/tweaks", NULL }, NULL);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, tar, NULL, NULL, (char **)&(const char*[]){ tar, "--preserve-permissions", "-xpf", "/taurine/zeusstrap.tar.gz", "-C", "/", NULL }, (char **)&myenviron);
        waitpid(pd, NULL, 0);
        goto end;
    }
end:
 printf("extracted bootstrap\n");
}


void installdebians(){

    if (file_exist("/.bootstrapped_Th0r14")){
        printf("skipping installing of debs\n");
        goto end;
    }else {
        //printf("installing of debs\n");
        //printf("[*]First delete SH Link to bash\n");
       mkdir("/taurine/pwnny/debs", 0777);
       posix_spawn(&pd, tar, NULL, NULL, (char **)&(const char*[]){ tar, "--preserve-permissions", "-xpf", "/taurine/pwnny/Deeznuts14.tar", "-C", "/taurine/pwnny/debs/", NULL }, (char **)&myenviron);
       waitpid(pd, NULL, 0);
       chown("/taurine/pwnny/debs/*", 0, 0);
       chmod("/taurine/pwnny/debs/*", 0777);
       posix_spawn(&pd, tar, NULL, NULL, (char **)&(const char*[]){ tar, "--preserve-permissions", "-xf", "/pwnremover/uicache.tar", "-C", "/pwnremover/", NULL }, (char **)&myenviron);
       waitpid(pd, NULL, 0);

        posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/bin/sh", NULL }, NULL);
        waitpid(pd, NULL, 0);
        //printf("[*]Make new SH Link to bash\n");
        posix_spawn(&pd, "/bin/ln", NULL, NULL, (char **)&(const char*[]){ "/bin/ln", "/bin/bash", "/bin/sh", NULL, NULL }, (char **)&myenviron);
        waitpid(pd, NULL, 0);
        posix_spawn(&pd, "/bin/sh", NULL, NULL, (char **)&(const char*[]){ "/bin/sh", "-c", "/usr/libexec/cydia/firmware.sh", NULL, NULL }, (char **)&myenviron);
        waitpid(pd, NULL, 0);
        

        
        printf("[*]are we done installing debs\n");
    }
    
end:
    printf("[*] installing debs\n");
}

void thesnap(){

    //runCommand("/taurine/bin/rm", "-rdf", "/Applications/Cydia.app &", NULL);
    //runCommand("/taurine/bin/sh", "-c", "/taurine/bin/rm -rdf /Applications/Cydia.app &", NULL);
    //runCommand("/taurine/bin/rm -rdf /Applications/Cydia.app &", NULL);
   // runCommand("/taurine/bin/rm", "-rdf", "/Applications/Cydia.app/ &", NULL);
   // posix_spawn(&pd, "/usr/bin/uicache", NULL, NULL, (char **)&(const char*[]){ "/usr/bin/uicache", NULL, NULL, NULL }, (char **)&myenviron);
    //waitpid(pd, NULL, 0);
    /*runCommand("/taurine/bin/rm", "-rdf", "/Applications/Cydia.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/SubstituteSettings.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Activator.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/ADManager.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Anemone.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Aphrodite.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/AppCake.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Audicy.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/AudioRecorder.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/BarrelSettings.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/BestCallerId.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/BobbyMovie.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Filza.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/MTerminal.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/calleridfaker.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Calleridfaker.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/CallLogPro.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/CallRecorder.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/CertRemainTime.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/ClassDumpGUI.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/CocoaTop.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Cr4shed.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/CrackTool3.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/CrackerXI+.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/crackerxi+.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/crackerxi.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/CrashReporter.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/CrackTool4.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Cydia\ Update\ Helper.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Cylinder.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/cydown.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Ext3nder.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Filza.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Flex.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Flex3Beta.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Flex3.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/iCleaner.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/icleaner.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/idevicewallsapp.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/jjjj.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/MobileTerminal.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/MovieBox3.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/MTerminal.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/NewTerm.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/NGXCarPlay.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/PopcornTime.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/PowerSelector.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Rehosts.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/ReProvision.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/RespringHelper.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/respringIcon.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Rollectra.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/RST.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/SafeMode.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/SafeModeApp.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Sileo.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/TSSSaver.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/UDIDCalculator.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/UDIDFaker.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/WiFiPasswords.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/WifiPasswordList.app", NULL);
    runCommand("/taurine/bin/rm", "-rdf", "/Applications/Zebra.app", NULL);

    */
    
    //runCommand("/taurine/bin/bash", "-c", "/taurine/uicache &", NULL);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Cydia.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/SubstituteSettings.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Activator.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/ADManager.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Anemone.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Aphrodite.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/AppCake.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Audicy.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/AudioRecorder.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/BarrelSettings.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/BestCallerId.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/BobbyMovie.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Filza.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/MTerminal.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Anemone.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/MTerminal.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
   
    //runCommand("/pwnremover/uicache", NULL);

    posix_spawn(&pd, "/pwnremover/uicache", NULL, NULL, (char **)&(const char*[]){ "/pwnremover/uicache", NULL, NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Cydia.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/SubstituteSettings.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Activator.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/ADManager.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Anemone.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Aphrodite.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/AppCake.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Audicy.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/AudioRecorder.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/BarrelSettings.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/BestCallerId.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/BobbyMovie.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Filza.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/MTerminal.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Anemone.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/MTerminal.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/calleridfaker.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Calleridfaker.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/CallLogPro.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/CallRecorder.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/CertRemainTime.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/ClassDumpGUI.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/CocoaTop.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Cr4shed.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/CrackTool3.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/CrackerXI+.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/crackerxi+.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/crackerxi.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/CrashReporter.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/CrackTool4.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Cydia\ Update\ Helper.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Cylinder.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/cydown.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Ext3nder.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Filza.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Flex.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Flex3Beta.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Flex3.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/GBA4iOS.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/iCleaner.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/icleaner.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/idevicewallsapp.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/jjjj.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/libhooker.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/MobileTerminal.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/MovieBox3.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/MTerminal.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/NewTerm.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/NGXCarPlay.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/PopcornTime.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/PowerSelector.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Rehosts.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/ReProvision.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/RespringHelper.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/respringIcon.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Rollectra.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/RST.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/SafeMode.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/SafeModeApp.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Sileo.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/TSSSaver.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/UDIDCalculator.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/UDIDFaker.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/WiFiPasswords.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/WifiPasswordList.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Applications/Zebra.app", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    //runCommand("/pwnremover/uicache", NULL);

    posix_spawn(&pd, "/pwnremover/uicache", NULL, NULL, (char **)&(const char*[]){ "/pwnremover/uicache", NULL, NULL, NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    //posix_spawn(&pd, "/taurine/uicache", NULL, NULL, (char **)&(const char*[]){ "/taurine/uicache", NULL, NULL, NULL, NULL }, (char **)&myenviron);
    //waitpid(pd, NULL, 0);

    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/apt", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/alternatives", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/default", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/dpkg", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/dropbear", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/motd", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/pam.d", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/profile", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/profile.d", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/profile.ro", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/rc.d", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/ssh", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/ssl", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/wgetrc", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/symlibs.dylib", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/etc/zshrc", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/private", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/containers/Bundle/dylibs", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/containers/Bundle/iosbinpack64", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/containers/Bundle/tweaksupport", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/log/jailbreakd-stderr.log", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/log/jailbreakd-stdout.log", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/backups", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/empty", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/bin", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/cache", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/cercube_stashed", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);

    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/db/stash", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/dropbear", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/Ext3nder-Installer", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/lib", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/var/lib", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/LIB", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/local", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/log/apt", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/log/dpkg", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
   // posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/db/sudo", NULL, NULL }, (char **)&myenviron);
     //waitpid(pd, NULL, 0);

    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/log/testbin.log", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/lock", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Activator", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Preferences/ws.hbang.Terminal.plist", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/SplashBoard/Snapshots/com.saurik.Cydia", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);

    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Application\ Support/Activator", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Application\ Support/Flex3", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Saved\ Application\ State/ws.hbang.Terminal.savedState", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Saved\ Application\ State/org.coolstar.SileoStore.savedState", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Saved\ Application\ State/com.saurik.Cydia.savedState", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
//    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/UserNotificationsServer/Library.plist/root/objects/item###/com.tigisoftware.Filza", NULL, NULL }, (char **)&myenviron);
//    waitpid(pd, NULL, 0);

    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/com.saurik.Cydia", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Cr4shed", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/CT4", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/CT3", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Cydia", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Flex3", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Filza", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Fingal", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/iWidgets", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/LockHTML", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Logs/Cydia", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Notchification", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/unlimapps_tweaks_resources", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Sileo", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/SBHTML", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Toonsy", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Widgets", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/libactivator.plist", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/com.johncoates.Flex", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/com.saurik.Cydia", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/AmyCache", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/org.coolstar.SileoStore", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/com.saurik.Cydia", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/com.saurik.Cydia", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/com.tigisoftware.Filza", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/Snapshots/com.saurik.Cydia", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/Snapshots/com.tigisoft.Filza", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/Snapshots/com.johncoates.Flex", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/Snapshots/org.coolstar.SafeMode", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/Snapshots/ws.hbang.Terminal", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Caches/Snapshots/org.coolstar.Sileo", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/Preferences/com.saurik.Cydia.plist", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);

    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/mobile/Library/libactivator.plist", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);

    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/motd", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/profile", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/run/pspawn_hook.ts", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/run/utmp", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/sbin", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/spool", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/tmp/cydia.log", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/tweak", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/private/var/unlimapps_tweak_resources", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Alkaline", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Activator", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/Snoverlay", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/Flame", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/CallBlocker", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/CCSupport", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/Compatimark", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/Malipo", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/SafariPlus.bundle", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/Activator", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/Cylinder", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/Barrel", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/BarrelSettings", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Application\ Support/libGitHubIssues", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Barrel", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/BarrelSettings", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Cylinder", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/dpkg", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Flipswitch", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Frameworks", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/LaunchDaemons", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/MobileSubstrate", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/PreferenceBundles", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/PreferenceLoader", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/SBInject", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Switches", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/test_inject_springboard.cy", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Themes", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/TweakInject", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/Zeppelin", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/Library/.DS_Store", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/System/Library/PreferenceBundles/AppList.bundle", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/System/Library/Themes", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/System/Library/KeyboardDictionaries", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/lib/libform.dylib", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/lib/libncurses.5.dylib", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/lib/libresolv.dylib", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/lib/liblzma.dylib", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/include", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/aclocal", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/bigboss", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/share/common-lisp", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/dict", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/dpkg", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/git-core", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/git-gui", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/gnupg", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/gitk", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/gitweb", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/libgpg-error", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/man", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/p11-kit", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/tabset", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/rm", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/rm", "-rdf", "/usr/share/terminfo", NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    //printf("[*] Trying find sauriks leftovers\n" );

   /* posix_spawn(&pd, "/taurine/bin/find", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/find", "/", "-iname", "cydia", "-type", "f", "-delete", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/taurine/bin/find", NULL, NULL, (char **)&(const char*[]){ "/taurine/bin/find", "/", "-iname", "saurik", "-type", "f", "-delete", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);*/
    
    //int rvchec1 = launch((char*)("/taurine/bin/find"), ".", "-name", "*.deb", "-type", "f", "-delete", NULL);
    //printf("[*] Found sauriks leftovers?\n" );
    ///////delete the Malware from Satan////
    
    
    //printf("[*] OK DON'T WORRY... It's not frozen.\nJust a very long uicache.\nPlease HOLD");
    posix_spawn(&pd, "/pwnremover/uicache", NULL, NULL, (char **)&(const char*[]){ "/pwnremover/uicache", NULL, NULL, NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    //runCommand("/pwnremover/uicache", NULL);
    //sleep(1);
    //printf("[*] Please HOLD\n");
    //printf("[*] Thanks for HOLDING\n");
        
}

#include <math.h>
char *itoa(long n) {
    int len = n==0 ? 1 : floor(log10l(labs(n)))+1;
    if (n<0) len++; // room for negative sign '-'
    
    char    *buf = calloc(sizeof(char), len+1); // +1 for null
    snprintf(buf, len+1, "%ld", n);
    return   buf;
}

void letskillliterallyeverythingneeded(){

    if (file_exist("/.bootstrapped_Th0r14")) {
        //printf("[*] Th0r exists skipping shit! \n");
        goto end;
    }
    int rv = open("/.bootstrapped_Th0r14", O_RDWR|O_CREAT);
    close(rv);
end:
    //printf("[*] Trying killall from /usr/bin \n");
    //runCommand("/usr/bin/killall", "-9", "runningboardd", NULL);
    posix_spawn(&pd, "/bin/sh", NULL, NULL, (char **)&(const char*[]){ "/bin/sh", "-c", "/usr/bin/killall -9 runningboardd", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
   // posix_spawn(&pd, "/bin/sh", NULL, NULL, (char **)&(const char*[]){ "/bin/sh", "-c", "killall -9 runningboardd", NULL }, (char **)&myenviron);
    //waitpid(pd, NULL, 0);
    posix_spawn(&pd, "/bin/sh", NULL, NULL, (char **)&(const char*[]){ "/bin/sh", "-c", "/usr/bin/killall -9 applecamerad videosubscriptionsd mediaserverd runningboardd", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    //runCommand("/usr/bin/killall", "-9", "applecamerad", NULL);
    posix_spawn(&pd, "/bin/sh", NULL, NULL, (char **)&(const char*[]){ "/bin/sh", "-c", "/usr/bin/killall -9 applecamerad", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    //runCommand("/usr/bin/killall", "-9", "videosubscriptionsd", NULL);
    posix_spawn(&pd, "/bin/sh", NULL, NULL, (char **)&(const char*[]){ "/bin/sh", "-c", "/usr/bin/killall -9 videosubscriptionsd", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    //runCommand("/usr/bin/killall", "-9", "mediaserverd", NULL);
    posix_spawn(&pd, "/bin/sh", NULL, NULL, (char **)&(const char*[]){ "/bin/sh", "-c", "/usr/bin/killall -9 mediaserverd", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    
    //runCommand("/usr/bin/killall", "-9", "/Applications/AppStore.App/AppStore", NULL);
    posix_spawn(&pd, "/bin/sh", NULL, NULL, (char **)&(const char*[]){ "/bin/sh", "-c", "/usr/bin/killall -9 /Applications/AppStore.App/AppStore", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    //runCommand("/usr/bin/killall", "-9", "AppStore", NULL);
    posix_spawn(&pd, "/bin/sh", NULL, NULL, (char **)&(const char*[]){ "/bin/sh", "-c", "/usr/bin/killall -9 AppStore", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    //runCommand("/usr/bin/killall", "-9", "appstored", NULL);
    posix_spawn(&pd, "/bin/sh", NULL, NULL, (char **)&(const char*[]){ "/bin/sh", "-c", "/usr/bin/killall -9 appstored", NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
    //runCommand("/usr/bin/killall -9 backboardd &", NULL);
    //runCommand("/bin/bash", "-c", "/usr/bin/killall backboardd &", NULL);
    printf("[*] I'll be right back\n");
}

void startsshing() {
/*
    printf("copying shell cmds in progress...\n");
    setenv("DYLD_LIBRARY_PATH", "/usr/lib", 1);
    setenv("PATH2", "/bin:/sbin:/usr/bin:/usr/sbin", 1);
    runCommand("/bin/bash", "-c", "nohup bash -c /usr/sbin/sshd -D -p 5555 -f \"/private/etc/ssh/sshd_config\" >/dev/null 2>&1 &", NULL);
    runCommand("/bin/bash", "-c", "/usr/sbin/sshd -D -p 5555 -f \"/private/etc/ssh/sshd_config\" >/dev/null 2>&1 &", NULL);
    runCommand("/bin/bash", "-c", "/usr/sbin/sshd -D -p 5555 &", NULL);
*/
    printf("SSH service started!\n");
}


void letskillall(){
    if (file_exist("/.bootstrapped_Th0r14")) {
        printf("[*] Th0r exists skipping shit! \n");
        goto end;
    }
    int rv = open("/.bootstrapped_Th0r14", O_RDWR|O_CREAT);
    close(rv);
end:
    //printf("[*] Trying killall from /usr/bin \n");
    //posix_spawn(&pd, "/usr/bin/uiopen", NULL, NULL, (char **)&(const char*[]){ "/usr/bin/uiopen", "cydia:///", NULL, NULL, NULL }, (char **)&myenviron);
    posix_spawn(&pd, "/usr/bin/killall", NULL, NULL, (char **)&(const char*[]){ "/usr/bin/killall", "backboardd", NULL, NULL, NULL }, (char **)&myenviron);
    waitpid(pd, NULL, 0);
}

void johnnycache(){
    if (file_exist("/.bootstrapped_Th0r14")){
        printf("[*] NOT attempting uicache\n");
    }else {
        printf("[*] attempting pwnremover uicache\n");
        sleep(1);
        if (file_exist("/pwnremover/uicache")){
//            runCommand("/bin/bash", "-c", "/pwnremover/uicache", NULL);

            int tryui2 = posix_spawn(&pd, "/pwnremover/uicache", NULL, NULL, (char **)&(const char*[]){ "/pwnremover/uicache", NULL, NULL, NULL, NULL, NULL }, (char **)&myenviron);
            waitpid(pd, NULL, 0);
            printf("[*] uicache from pwnremover donz=%d\n",tryui2);
        } else {
  //          runCommand("/bin/bash", "-c", "/usr/bin/uicache", NULL);
            int tryui2 = posix_spawn(&pd, "/usr/bin/uicache", NULL, NULL, (char **)&(const char*[]){ "/usr/bin/uicache", NULL, NULL, NULL, NULL, NULL }, (char **)&myenviron);
            waitpid(pd, NULL, 0);
            printf("[*] uicache from usr/bin donz=%d\n",tryui2);
        }
    }
}
